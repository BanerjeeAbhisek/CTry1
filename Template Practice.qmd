---
title: "Normalising Flows"
author: "Abhisek Banerjee"

format:
  revealjs:
    theme: [default, custom.scss]
    css: styles.css

    # Slide geometry
    width: 1280
    height: 720
    margin: 0.05
    center: false

    # Navigation & behavior
    transition: slide
    background-transition: fade
    slide-number: true
    progress: true
    controls: true
    hash: true
    preview-links: true
    incremental: false
    chalkboard: true
    code-line-numbers: true

    # Math rendering
    html-math-method: katex

    # Tiger-stripe background ONLY for title slide
    title-slide-attributes:
      data-background-image: "assets/tigerstripes.png"
      data-background-size: "cover"
      data-background-position: "center"

    # Fonts & head includes
    include-in-header:
      text: |
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet">

    # Footer + Home button
    include-after-body:
      text: |
        <div class="mizzou-footer-bar">
          <div class="mizzou-left">
            <img src="assets/mizzou-logo.svg" alt="Mizzou logo">
          </div>
          <div class="mizzou-right">
            Departpemt of Statistics / Class 9100
          </div>
        </div>

        <a class="home-btn" href="#outline" title="Go to Outline" aria-label="Go to Outline">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M3 10.5L12 3l9 7.5V21a1 1 0 0 1-1 1h-5v-6H9v6H4a1 1 0 0 1-1-1z"/>
          </svg>
        </a>

resources:
  - styles.css
  - assets
---

## Outline {#outline}

<div class="toc-card">

1. [Motivation](#motivation)  
2. [Model Setup](#model-setup)  
3. [Method](#method)  
4. [Results](#results)  
5. [Conclusion](#conclusion)

</div>



## Quarto {#motivation}

Quarto enables you to weave together content and executable code into a finished presentation. To learn more about Quarto presentations see 

$\beta = v_1$

## Code

When you click the **Render** button a presentation will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
1 + 1
```


##  Gold Box test  {#model-setup}

<br>

<div class="mizzou-gold-box">

This is an important takeaway  
that I want the audience  
to remember. $\beta$ 

</div>


## Code Example {#method}

<div class="mizzou-code-box">
```{r}
#| echo: true
x <- rnorm(100)
mean(x)


```
</div>


## Model Setup with incremantal {#results}

::: {.incremental}
- Linear regression framework
- Gaussian noise assumption
- Parameters estimated via MLE
:::



## Model Setup without incremantal {#conclusion}

- Linear regression framework
- Gaussian noise assumption
- Parameters estimated via MLE



## Model Setup

- Data
  - i.i.d. observations
  - standardized covariates
- Model
  - linear predictor $x^\top \beta$
  - Gaussian noise
- Inference
  - MLE / MAP
  - uncertainty quantification


<div class="mizzou-code-box">
```{r eval=FALSE}
#| echo: true
x <- rnorm(100)
median(x)


```
</div>
  
## Two Column Test

### Model

- Linear regression
- Gaussian noise
- Estimated via MLE

![](pictures/habla.png){width=80%, height=420px}



## Why we need richer variational posteriors

::: columns
::: column
### Variational inference (ELBO)

We approximate the intractable posterior with a tractable family:

$q_\phi(z\mid x) \approx p_\theta(z\mid x)$

\[
\log p_\theta(x)\ \ge\ 
\mathbb{E}_{q_\phi(z\mid x)}[\log p_\theta(x\mid z)]
-\mathrm{D_{KL}}\!\big(q_\phi(z\mid x)\,\|\,p(z)\big)
\]

**In practice:** choose a simple \(q_\phi\) so gradients are cheap.
:::

::: column
### The bottleneck: limited \(q_\phi\)

Common choice (fast, but restrictive):

- Mean-field / diagonal Gaussian  
  \(q_\phi(z\mid x)=\mathcal{N}(\mu_\phi(x),\mathrm{diag}(\sigma^2_\phi(x)))\)

**Issues reported in VI:**
- misses dependencies / multimodality
- often **underestimates posterior variance**
- can bias parameter estimates

So even with infinite data/compute, **VI may not match** \(p_\theta(z\mid x)\).
:::
:::





## Geometric intuition (visual)

*Expansions spread mass; contractions concentrate mass.*

```{ojs}
chart = {
  // d3 is available globally from include-in-header
  const W = 800, H = 420, pad = 30;

  const x = d3.scaleLinear().domain([-2,2]).range([pad, W-pad]);
  const y = d3.scaleLinear().domain([-1.4,1.4]).range([H-pad, pad]);

  const pts = [];
  for (let xx=-2; xx<=2.001; xx+=0.18) {
    for (let yy=-1.4; yy<=1.4001; yy+=0.18) {
      pts.push([xx,yy]);
    }
  }

  const svg = d3.create("svg")
    .attr("viewBox", `0 0 ${W} ${H}`)
    .style("width","100%")
    .style("height","420px")
    .style("border","1px solid rgba(255,255,255,0.2)")
    .style("border-radius","12px");

  svg.selectAll("circle")
    .data(pts)
    .join("circle")
      .attr("r", 2)
      .attr("opacity", 0.7)
      .attr("cx", d => x(d[0]))
      .attr("cy", d => y(d[1]));

  return svg.node();
}



```








##  {data-background-image="assets/tigerstripes.png" data-background-size="cover" data-background-position="center"}

<div class="thankyou-slide">

<div class="thankyou-content">

Thank you for your attention!


</div>

</div>


